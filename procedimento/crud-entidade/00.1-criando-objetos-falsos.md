---
layout: post
title: "Implementando Entidades: Objetos falsos"
author: "Tiago Aguiar"
user: "taguiar"
date: "2012-03-15"
published: true
partof: procedimento-crud-entidade
num: 1
---

## <a id="TOPO"> </a>Introdução
Após a implementação de nossa entidade Funcionário é preciso criar os objetos falsos equivalentes a nossa
entidade Funcionário, os mesmos serão adicionados futuramente no banco de dados e serão utilizados para
testar rotinas que [CRUD] (http://pt.wikipedia.org/wiki/CRUD) voltadas a um Funcionario.

Nota: Os teste não fazem parte do escopo deste artigo.

## Antes de iniciar
Este item exige conhecimentos sobre:

- [TDD](http://dojo.objectos.com.br/caixa/processo-00-TDD.html)
- Construtores


## Criando Objetos Falsos
Siga o checklist abaixo:
<table class="table table-bordered">
  <tr>
   <td class="tac col2em">
    <a id="topo_0_0"><input type="checkbox" /></a>
   </td>
   <td>
	Onde e como criar construtores falsos?
   </td>
   <td>
    <a href="#0_1">help!</a>
   </td>
 </tr>
  <tr>
   <td class="tac col2em">
    <a id="topo_0_0"><input type="checkbox" /></a>
   </td>
   <td>
	Onde e como criar objetos falsos?
   </td>
   <td>
    <a href="#0_2">help!</a>
   </td>
 </tr>
</table>

### <a id="0_1"> </a>Onde e como criar construtores falsos?
Os construtores falsos ficarão no mesmo pacote que a interface, porém no diretório de testes 
`/src/test/java/` do projeto com o nome padrão: `ConstrutorDeNomeDaEntidadeFalso.java`

<ol>
  <li>Crie a classe `ConstrutorDeFuncionarioFalso`</li>
  <li>Implemente a interface `Funcionario.Construtor`</li>
  <li>Crie os atributos definidos na interface</li>
  <li>Crie um método destes atributos retornando `ConstrutorDeFuncionarioFalso`</li>
  <li>Crie um método `novaInstancia()` retornando `Funcionario`</li>
</ol> 

    public class ConstrutorDeFuncionarioFalso implements Funcionario.Construtor {
    
      private String nome;
      private String matricula;
      private LocalDate dataNascimento;
      private LocalDate dataAdmissao;
      private LocalDate dataDemissao;
      private Superior superior;
      private Diretor diretor;
    
      @Override
      public Funcionario novaInstancia() {
        return new FuncionarioJdbc(this);
      }
    
      public ConstrutorDeFuncionarioFalso nome(String nome) {
        this.nome = nome;
        return this;
      }
    
      public ConstrutorDeFuncionarioFalso matricula(String matricula) {
        this.matricula = matricula;asilva
        return this;
      }
    
      public ConstrutorDeFuncionarioFalso dataNascimento(LocalDate dataNascimento) {
        this.dataNascimento = dataNascimento;
        return this;
      }
    
      public ConstrutorDeFuncionarioFalso dataAdmissao(LocalDate dataAdmissao) {
        this.dataAdmissao = dataAdmissao;
        return this;
      }
    
      public ConstrutorDeFuncionarioFalso dataDemissao(LocalDate dataDemissao) {
        this.dataDemissao = dataDemissao;
        return this;
      }
    
      public ConstrutorDeFuncionarioFalso superior(Superior superior) {
        this.superior = superior;
        return this;
      }
    
      public ConstrutorDeFuncionarioFalso diretor(Diretor diretor) {
        this.diretor = diretor;
        return this;
      }
    
      @Override
      public String getNome() {
        return nome;
      }
    
      @Override
      public String getMatricula() {
        return matricula;
      }
    
      @Override
      public LocalDate getDataNascimento() {
        return dataNascimento;
      }
    
      @Override
      public LocalDate getDataAdmissao() {
        return dataAdmissao;
      }
    
      @Override
      public LocalDate getDataDemissao() {
        return dataDemissao;
      }
    
      @Override
      public Superior getSuperior() {
        return superior;
      }
    
      @Override
      public Diretor getDiretor() {
        return diretor;
      }
    
    }
		
Com um construtor falso podemos criar todos os objetos __Funcionario__ com os atributos que definimos
anteriormente. Estes objetos serão instanciados na classe __FuncionariosFalso__.		

### <a id="0_2"> </a>Onde e como criar objetos falsos?
Os objetos falsos ficarão no mesmo diretório dos construtores falsos `/src/test/java/` com o nome padrão:
`NomeDaEntidadeFalso.java`


<ol>
  <li>Crie a classe `FuncionariosFalso, com `Ctrl + A` selecione a interface EntitySet para a implementar`</li>
  <li>Com `Ctrl + 1` adicione os métodos exigidos pela assinatura da interface</li>
  <li>Crie os objetos constantes</li>
  <li>Crie um método `novo()` retornando um novo objeto `ConstrutorDeFuncionarioFalso`</li>
  <li>Crie uma lista imutavél armazenando todos os objetos falsos</li>
  <li>Crie um método `getTodos()`</li>
  <li>Implemente o método `load(SqlUnit sqlUnit)` passando por parametro a lista dos falsos</li>
  <li>Implemente o método `truncate(Truncate truncate)` passando por parametro o nome da tabela em que serão armazenados os dados</li>
  <li>Com `Alt + shift + C` crie um construtor sem argumnetos com acesso `default` e selecione a opção `"Omit call to default constructor super()"`</li>
</ol> 

    public class FuncionariosFalso implements EntitySet {
    
      public static final Funcionario FUNCIONARIO_1 = novo()
          .nome("Funcionario 1")
          .matricula("T0033000")
          .dataNascimento(new LocalDate(1980, 6, 01))
          .dataAdmissao(new LocalDate(2004, 12, 10))
          .dataDemissao(new LocalDate(2012, 1, 3))
          .superior(SUPERIOR_1)
          .diretor(DIRETOR_1)
          .novaInstancia();
      public static final Funcionario FUNCIONARIO_2 = novo()
          .nome("Funcionario 2")
          .matricula("00112")
          .dataNascimento(new LocalDate(1982, 6, 01))
          .dataAdmissao(new LocalDate(2004, 10, 10))
          .dataDemissao(new LocalDate(2012, 3, 3))
          .superior(SUPERIOR_1)
          .diretor(DIRETOR_2)
          .novaInstancia();
      public static final Funcionario FUNCIONARIO_3 = novo()
          .nome("Funcionario 3")
          .matricula("T0033010")
          .dataNascimento(new LocalDate(1980, 6, 01))
          .dataAdmissao(new LocalDate(2007, 12, 10))
          .dataDemissao(new LocalDate(2012, 6, 3))
          .superior(SUPERIOR_1)
          .diretor(DIRETOR_3)
          .novaInstancia();
    
      public static final Funcionario FUNCIONARIO_4 = novo()
          .nome("Funcionario 4")
          .matricula("T00330500")
          .dataNascimento(new LocalDate(1976, 6, 01))
          .dataAdmissao(new LocalDate(2005, 12, 10))
          .dataDemissao(new LocalDate(2012, 12, 3))
          .superior(SUPERIOR_2)
          .diretor(DIRETOR_1)
          .novaInstancia();
      public static final Funcionario FUNCIONARIO_5 = novo()
          .nome("Funcionario 5")
          .matricula("001123")
          .dataNascimento(new LocalDate(1982, 6, 01))
          .dataAdmissao(new LocalDate(1999, 10, 10))
          .dataDemissao(new LocalDate(2012, 5, 3))
          .superior(SUPERIOR_2)
          .diretor(DIRETOR_2)
          .novaInstancia();
      public static final Funcionario FUNCIONARIO_6 = novo()
          .nome("Funcionario 6")
          .matricula("T0033011")
          .dataNascimento(new LocalDate(1980, 6, 01))
          .dataAdmissao(new LocalDate(2007, 11, 10))
          .dataDemissao(new LocalDate(2012, 9, 3))
          .superior(SUPERIOR_2)
          .diretor(DIRETOR_3)
          .novaInstancia();
    
      public static List<Funcionario> todos = ImmutableList.<Funcionario> builder()
          .add(FUNCIONARIO_1)
          .add(FUNCIONARIO_2)
          .add(FUNCIONARIO_3)
    
          .add(FUNCIONARIO_4)
          .add(FUNCIONARIO_5)
          .add(FUNCIONARIO_6)
          .build();
    
      public static List<Funcionario> getTodos() {
        return todos;
      }
    
      FuncionariosFalso() {
      }
    
      @Override
      public void truncate(Truncate truncate) {
        truncate.table("DATABASE.FUNCIONARIO");
      }
    
      @Override
      public void load(SqlUnit sqlUnit) {
        sqlUnit.batchInsert(todos);
      }
    
      private static ConstrutorDeFuncionarioFalso novo() {
        return new ConstrutorDeFuncionarioFalso();
      }
    
    }

Nota: Utilize o conceito de __Fluent Interface__ que são métodos encadeados para proporcionar um código
mais legível. 

## Códigos-fonte
[ConstrutorDeFuncionarioFalso.java](https://github.com/objectos/objectos-dojo/tree/master/objectos-dojo-team/src/test/java/br/com/objectos/dojo/empresa/ConstrutorDeFuncionarioFalso.java)<br>
[FuncionariosFalso.java](https://github.com/objectos/objectos-dojo/tree/master/objectos-dojo-team/src/test/java/br/com/objectos/dojo/empresa/FuncionariosFalso.java)<br>

Siga para o próximo passo. Scripts flyway! <a href="{{ site.url }}/procedimento/crud-entidade/00.3-criando-testando-script-flyway.html" class="btn btn-success">Continuar!</a><br>
Leia mais uma vez! <a href="#TOPO" class="btn btn-warning">Revisar!</a>